{% extends "base_generic.html" %}

{% block content %}
    <h1 class="page-title">{{ schedule.schedule_period|date:"F Y" }}</h1>
    <div class="schedule-button-container">
        <a href="{% url 'download_schedule_csv' schedule.id %}" class="general-button">CSV</a>
        <a href="{% url 'download_schedule_csv' schedule.id %}" class="general-button">PDF</a>
        <a href="{% url 'schedule_delete' schedule.id %}" class="delete-button">Delete</a>
    </div>
    <h2 class="section-type">Per day</h2>
    <table class="schedule-table">
        <thead>
            <tr class="schedule-table-row">
                <th class="schedule-table-data">Day</th>
                <th class="schedule-table-data">Assigned Employees</th>
            </tr>
        </thead>
        <tbody>
            {% for day in schedule.per_day_schedule %}
            <tr class="schedule-table-row">
                <td class="schedule-table-data">{{ day.iso_date }}</td>
                <td class="schedule-table-data">
                    <div class="assigned-employess-container">
                        {% for employee in day.daily_employees %}
                            <div>{{ employee.name }}</div>
                        {% endfor %}
                    </div>
                </td>
            </tr>
            {% endfor %}
        </tbody>
    </table>



    <h2 class="section-type">Per employee</h2>
    <table class="schedule-table">
        <thead>
            <tr class="schedule-table-row">
                <th class="schedule-table-data">Employee Name</th>
                <th class="schedule-table-data">Assigned Days</th>
            </tr>
        </thead>
        <tbody>
            {% for employee in schedule.per_employee_schedule %}
            <tr class="schedule-table-row">
                <td class="schedule-table-data">{{ employee.name }}</td>
                <td class="schedule-table-data">
                    <div class="assigned-employess-container">
                        {% for day in employee.days %}
                            <div>{{ day }}</div>
                        {% endfor %}
                    </div>
                </td>
            </tr>
            {% endfor %}
        </tbody>
    </table>

    <h2 class="section-type">Schedule stats</h2>

    <table class="schedule-table">
        <tr class="schedule-table-row">
            <td class="schedule-table-data">Shift diffence</td>
            <td class="schedule-table-data">{{ schedule.schedule_stats.max_shifts_min_shifts }}</td>
        </tr>
        <tr class="schedule-table-row">
            <td class="schedule-table-data">Weekend shift difference</td>
            <td class="schedule-table-data">{{ schedule.schedule_stats.max_wknd_shifts_min_wknd_shifts }}</td>
        </tr>
        <tr class="schedule-table-row">
            <td class="schedule-table-data">1-shift-max interval</td>
            <td class="schedule-table-data">{{ schedule.schedule_stats.theoretical_intervals }}</td>
        </tr>
        <tr class="schedule-table-row">
            <td class="schedule-table-data">Interval violations</td>
            <td class="schedule-table-data">{{ schedule.schedule_stats.interval_violations|length }}</td>
        </tr>
        <tr class="schedule-table-row">
            <td class="schedule-table-data">Max shift violations:</td>
            <td class="schedule-table-data">{{schedule.schedule_stats.shift_violations|length}}</td>
        </tr>
        <tr class="schedule-table-row">
            <td class="schedule-table-data">Max weekend shift violations:</td>
            <td class="schedule-table-data">{{schedule.schedule_stats.wknd_shift_violations|length}}</td>
        </tr>
    </table>

    {% if schedule.schedule_stats.interval_violations %}
        <ul>
            {% for violation in schedule.schedule_stats.interval_violations %}
                <li>{{violation}}</li>
            {% endfor %}
        </ul>
    {% endif %}

{% endblock %}
