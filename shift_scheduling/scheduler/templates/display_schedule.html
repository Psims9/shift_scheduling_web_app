{% extends "base_generic.html" %}

{% block content %}
<div class="content-section">
    <h1 class="section-title">{{ schedule.schedule_period|date:"F Y" }} Schedule</h1>

    <div class="action-bar">
        <a class="btn-primary" href="{% url 'schedule_download_csv' schedule.id %}">
            Download CSV
        </a>
    </div>

    <div class="schedule-stats">
        <p><strong>Max shifts - min shifts difference:</strong> {{ schedule.schedule_stats.max_shifts_min_shifts }}</p>
        <p><strong>Max weekend shifts - min weekend shifts difference:</strong> {{ schedule.schedule_stats.max_wknd_shifts_min_wknd_shifts }}</p>
        <p><strong>Theoretical minimum 1-shift-max interval:</strong> {{ schedule.schedule_stats.theoretical_intervals }} days</p>
        <p><strong>Interval violations:</strong> {{ schedule.schedule_stats.interval_violations|length }}</p>

        {% if schedule.schedule_stats.interval_violations %}
            <ul class="item-list">
                {% for violation in schedule.schedule_stats.interval_violations %}
                    <li class="item-list-row">{{ violation }}</li>
                {% endfor %}
            </ul>
        {% endif %}
    </div>

    <h2 class="section-title">Per Day</h2>
    <div class="table-wrapper">
        <table class="styled-table">
            <thead>
                <tr>
                    <th>Day</th>
                    <th>Assigned Employees</th>
                </tr>
            </thead>
            <tbody>
                {% for day in schedule.per_day_schedule %}
                <tr>
                    <td>{{ day.iso_date }}</td>
                    <td>
                        {% for employee in day.daily_employees %}
                            <div>{{ employee.name }} (id: {{ employee.id }})</div>
                        {% endfor %}
                    </td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>

    <h2 class="section-title">Per Employee</h2>
    <div class="table-wrapper">
        <table class="styled-table">
            <thead>
                <tr>
                    <th>Employee Name</th>
                    <th>Assigned Days</th>
                </tr>
            </thead>
            <tbody>
                {% for employee in schedule.per_employee_schedule %}
                <tr>
                    <td>{{ employee.name }} (id: {{ employee.id }})</td>
                    <td>
                        {% for day in employee.days %}
                            <div>{{ day }}</div>
                        {% endfor %}
                    </td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>
</div>
{% endblock %}
