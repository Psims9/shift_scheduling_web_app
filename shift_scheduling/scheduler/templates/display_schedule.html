{% extends "base_generic.html" %}

{% block content %}
<h1>{{ schedule.schedule_period|date:"F Y" }} Schedule</h1>

<p><strong>Solution:</strong> {{ schedule.schedule_stats.status }}</p>
<p><strong>Max shifts - min shifts difference:</strong> {{ schedule.schedule_stats.max_shifts_min_shifts }}</p>
<p><strong>Max weekend shifts - min weekend shifts difference:</strong> {{ schedule.schedule_stats.max_wknd_shifts_min_wknd_shifts }}</p>
<p><strong>Theoretical minimum 1-shift-max interval:</strong> {{ schedule.schedule_stats.theoretical_intervals }} days</p>
<p><strong>Interval violations:</strong> {{ schedule.schedule_stats.interval_violations|length }}</p>
{% if schedule.schedule_stats.interval_violations %}
    <ul>
        {% for violation in schedule.schedule_stats.interval_violations %}
            <li>{{ violation }}</li>
        {% endfor %}
    </ul>
{% endif %}

<h2>Per day</h2>
<table border="1" cellpadding="5" cellspacing="0" style="width: 27%;">
    <thead>
        <tr>
            <th style="text-align: center; vertical-align: middle;">Day</th>
            <th style="text-align: center; vertical-align: middle;">Assigned Employees</th>
        </tr>
    </thead>
    <tbody>
        {# iterate dict items: key = date string, value = dict of workers #}
        {% for day, workers in schedule.per_day_schedule.items %}
        <tr>
            <td style="text-align: center; vertical-align: middle;">{{ day }}</td>
            <td style="text-align: center; vertical-align: middle;">
                {% if workers %}
                    {% for e_id, worker in workers.items %}
                        <div>{{ worker.name }}</div>
                    {% endfor %}
                {% else %}
                    <div>No one assigned</div>
                {% endif %}
            </td>
        </tr>
        {% endfor %}
    </tbody>
</table>

<br>

<h2>Per employee</h2>
<table border="1" cellpadding="5" cellspacing="0" style="width: 27%;">
    <thead>
        <tr>
            <th style="text-align: center; vertical-align: middle;">Employee Name</th>
            <th style="text-align: center; vertical-align: middle;">Assigned Days</th>
        </tr>
    </thead>
    <tbody>
        {# iterate employee dict items: key = employee id, value = {'name': ..., 'days': [...]} #}
        {% for e_id, emp in schedule.per_employee_schedule.items %}
        <tr>
            <td style="text-align: center; vertical-align: middle;">{{ emp.name }}</td>
            <td style="text-align: center; vertical-align: middle;">
                {% if emp.days %}
                    {% for date in emp.days %}
                        <div>{{ date }}</div>
                    {% endfor %}
                {% else %}
                    <div>â€”</div>
                {% endif %}
            </td>
        </tr>
        {% endfor %}
    </tbody>
</table>
{% endblock %}
