{% extends "base_generic.html" %}

{% block content %}
    <h1 class="page-title">Schedules</h1>
    <div class="schedule-list-button-container" style="margin-bottom: 2rem; border-bottom: 1px solid rgb(120, 120, 120); padding-bottom: 1rem;">
        <a href="{% url 'create_schedule' %}" class="add-new-button">+ New</a>
        <input type="text" id="searchInput" placeholder="Search schedules..." class="search-bar">
    </div>
    {% if schedule_list %}
        <table class="inst-table">
            <colgroup>
                <col class="inst-id-column">
                <col class="inst-name-column">
            </colgroup>
            <thead>
                <tr class="inst-table-header-row">
                    <th class="inst-table-data"><b>ID</b></th>
                    <th class="inst-table-data"><b>Schedule Period</b></th>
                </tr>
                <tbody>
                    {% for schedule in schedule_list %}
                        <tr class="inst-table-data-row">
                            <td class="inst-table-data">{{schedule.id}}</td>
                            <td class="inst-table-data"><a href="{{ schedule.get_absolute_url }}" class="inst-detail-link">{{schedule}}</a></td>
                        </tr>
                    {% endfor %}
                </tbody>
            </thead>
        </table>
    {% else %}
        <p>There are no schedules.</p>
    {% endif %}

    <script>
        const searchInput = document.getElementById('searchInput');
        const tableRows = document.querySelectorAll('.inst-table-data-row');

        searchInput.addEventListener('input', function (e) {
            const query = e.target.value.toLowerCase();

            tableRows.forEach(row => {
                const nameCell = row.querySelector('.inst-table-data:nth-child(2)');
                const nameText = nameCell.textContent.toLowerCase();

                // Show/hide row based on match
                if (nameText.includes(query)) {
                    row.style.display = '';
                } else {
                    row.style.display = 'none';
                }
            });
        });
    </script>
{% endblock %}