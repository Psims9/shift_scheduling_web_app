{% extends "base_generic.html" %}

{% block content %}
    <h1 class="page-title">Employees</h1>
    <div class="employee-list-button-container" style="margin-bottom: 2rem;">
        <a href="{% url 'worker_create' %}" class="add-new-button">+ Add new</a>
        <input type="text" id="searchInput" placeholder="Search employees..." class="search-bar">
    </div>
    {% if worker_list %}
        <table class="employee-table" style="margin-bottom: 4rem;">
            <colgroup>
                <col class="id-column">
                <col class="name-column">
            </colgroup>
            <thead>
                <tr class="employee-table-header-row">
                    <th class="employee-table-data"><b>ID</b></th>
                    <th class="employee-table-data"><b>Name</b></th>
                </tr>
            </thead>
            <tbody>
                {% for worker in worker_list %}
                    <tr class="employee-table-data-row">
                        <td class="employee-table-data">{{worker.id}}</td>
                        <td class="employee-table-data"><a href="{{ worker.get_absolute_url }}" class="employee-detail-link">{{worker}}</a></td>
                    </tr>
                {% endfor %}
            </tbody>
        </table>
    {% else %}
    <p>There are no workers yet.</p>
    {% endif %}

    <script>
        const searchInput = document.getElementById('searchInput');
        const tableRows = document.querySelectorAll('.employee-table-data-row');

        searchInput.addEventListener('input', function (e) {
            const query = e.target.value.toLowerCase();

            tableRows.forEach(row => {
                const nameCell = row.querySelector('.employee-table-data:nth-child(2)');
                const nameText = nameCell.textContent.toLowerCase();

                // Show/hide row based on match
                if (nameText.includes(query)) {
                    row.style.display = '';
                } else {
                    row.style.display = 'none';
                }
            });
        });
    </script>

{% endblock %}